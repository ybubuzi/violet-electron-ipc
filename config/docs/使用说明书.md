# Violet Electron IPC æ¡†æ¶ä½¿ç”¨è¯´æ˜ä¹¦

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
3. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
4. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
5. [è¯¦ç»†ä½¿ç”¨æŒ‡å—](#è¯¦ç»†ä½¿ç”¨æŒ‡å—)
6. [é«˜çº§ç‰¹æ€§](#é«˜çº§ç‰¹æ€§)
7. [æ„å»ºä¸éƒ¨ç½²](#æ„å»ºä¸éƒ¨ç½²)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
9. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ“– é¡¹ç›®æ¦‚è¿°

Violet Electron IPC æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”è®¾è®¡ä¼˜é›…çš„ Electron IPCï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰æ¡†æ¶ï¼Œæ—¨åœ¨ç®€åŒ–ä¸»è¿›ç¨‹ä¸æ¸²æŸ“å™¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚è¯¥æ¡†æ¶åˆ©ç”¨ç°ä»£ JavaScript ç‰¹æ€§ï¼Œæä¾›æ— ç¼ã€ç±»å‹å®‰å…¨ä¸”æ— éœ€ç¹çæ ·æ¿ä»£ç çš„å¼€å‘ä½“éªŒã€‚

### æ ¸å¿ƒä»·å€¼

- **çº¦å®šä¼˜äºé…ç½®**ï¼šåŸºäºæ–‡ä»¶ç»“æ„çš„è‡ªåŠ¨ API æš´éœ²æœºåˆ¶
- **é›¶æ ·æ¿ä»£ç **ï¼šæ— éœ€æ‰‹åŠ¨æ³¨å†Œ IPC é€šé“
- **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript æ”¯æŒ
- **å†…å­˜å®‰å…¨**ï¼šè‡ªåŠ¨æ¸…ç†äº‹ä»¶ç›‘å¬å™¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
- **ä¸Šä¸‹æ–‡ä¼ æ’­**ï¼šéšå¼çš„å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1. åŠ¨æ€ä»£ç†å®¢æˆ·ç«¯
æ¸²æŸ“å™¨è¿›ç¨‹ä½¿ç”¨åŠ¨æ€ `Proxy` åˆ›å»ºä¸€ä¸ªé•œåƒä¸»è¿›ç¨‹ API çš„å®¢æˆ·ç«¯ï¼Œä½¿æ‚¨å¯ä»¥åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨ä¸»è¿›ç¨‹å‡½æ•°ï¼š

```typescript
// åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨ä¸»è¿›ç¨‹ API
const result = await window.api.module.functionName()
```

### 2. è‡ªåŠ¨ API æ³¨å†Œ
åŸºäºæ–‡ä»¶ç»“æ„è‡ªåŠ¨å‘ç°å¹¶æš´éœ²ä¸»è¿›ç¨‹ APIï¼Œæ— éœ€æ‰‹åŠ¨æ³¨å†Œï¼š

```
src/main/ipc/
â”œâ”€â”€ greeter.ts          â†’ api.greeter
â”œâ”€â”€ message/
â”‚   â”œâ”€â”€ index.ts        â†’ api.message
â”‚   â””â”€â”€ shy-girl.ts     â†’ api.message.shy
â””â”€â”€ window/
    â””â”€â”€ index.ts        â†’ api.window
```

### 3. éšå¼ä¸Šä¸‹æ–‡ä¼ æ’­
åˆ©ç”¨ Node.js çš„ `AsyncLocalStorage`ï¼Œ`IpcMainInvokeEvent` åœ¨ IPC å¤„ç†ç¨‹åºçš„æ•´ä¸ªè°ƒç”¨å †æ ˆä¸­éšå¼å¯ç”¨ï¼š

```typescript
// ä»»ä½•å‡½æ•°éƒ½èƒ½è®¿é—®å‘é€æ–¹çš„ BrowserWindowï¼Œè€Œæ— éœ€æ‰‹åŠ¨ä¼ é€’äº‹ä»¶å¯¹è±¡
export function maximize() {
  const event = getStore<IpcMainInvokeEvent>();
  const window = BrowserWindow.fromWebContents(event.sender);
  if (window) {
    window.maximize();
  }
}
```

### 4. æ— å†…å­˜æ³„æ¼çš„é€šçŸ¥ç³»ç»Ÿ
å‘å¸ƒ/è®¢é˜…ç³»ç»Ÿä½¿ç”¨ `WeakRef` è‡ªåŠ¨ç®¡ç†æ¸²æŸ“å™¨ä¸­äº‹ä»¶ç›‘å¬å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼š

```vue
<script setup>
onMounted(() => {
  // ç›‘å¬å™¨ä¼šè‡ªåŠ¨ç»‘å®šåˆ°ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
  window.notify.addListener('download-complete', onDownloadUpdate);
});
// ç»„ä»¶é”€æ¯æ—¶ï¼Œç›‘å¬å™¨è‡ªåŠ¨è¢«ç§»é™¤ï¼Œæ— éœ€æ‰‹åŠ¨æ¸…ç†
</script>
```

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    IPCé€šä¿¡     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ¸²æŸ“å™¨è¿›ç¨‹      â”‚ â†----------â†’  â”‚    ä¸»è¿›ç¨‹        â”‚
â”‚                â”‚               â”‚                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   ä»£ç†å®¢æˆ·ç«¯   â”‚ â”‚               â”‚ â”‚  APIå¤„ç†å™¨   â”‚ â”‚
â”‚ â”‚   (Proxy)   â”‚ â”‚               â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                â”‚               â”‚                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚               â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  é€šçŸ¥ç›‘å¬å™¨   â”‚ â”‚               â”‚ â”‚  é€šçŸ¥å‘é€å™¨   â”‚ â”‚
â”‚ â”‚ (WeakRef)   â”‚ â”‚               â”‚ â”‚             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚               â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ ipc/                    # ä¸»è¿›ç¨‹ API æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts           # æ ¸å¿ƒï¼šæ‰«ææ¨¡å—å¹¶è®¾ç½® ipcMain.handle
â”‚   â”‚   â”œâ”€â”€ ctx.ts             # æ ¸å¿ƒï¼šä½¿ç”¨ AsyncLocalStorage ç®¡ç†ä¸Šä¸‹æ–‡
â”‚   â”‚   â”œâ”€â”€ handles.ts         # èšåˆæ‰€æœ‰ API æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ message/           # æ¶ˆæ¯ç›¸å…³ API
â”‚   â”‚   â”œâ”€â”€ window/            # çª—å£ç›¸å…³ API
â”‚   â”‚   â”œâ”€â”€ notify/            # é€šçŸ¥ç³»ç»Ÿ API
â”‚   â”‚   â””â”€â”€ store/             # å­˜å‚¨ç›¸å…³ API
â”‚   â”œâ”€â”€ notify/                # é€šçŸ¥ç³»ç»Ÿå®ç°
â”‚   â”‚   â””â”€â”€ index.ts           # äº‹ä»¶ç®¡ç†å’Œåˆ†å‘
â”‚   â””â”€â”€ index.ts               # ä¸»è¿›ç¨‹å…¥å£
â”‚
â”œâ”€â”€ preload/
â”‚   â””â”€â”€ index.ts               # å‘æ¸²æŸ“å™¨æš´éœ² IPC API
â”‚
â””â”€â”€ renderer/
    â””â”€â”€ handle.ts              # æ ¸å¿ƒï¼šæ¸²æŸ“å™¨çš„ä»£ç†å®¢æˆ·ç«¯å®ç°
```

### æ ¸å¿ƒç»„ä»¶è¯´æ˜

#### 1. ä¸»è¿›ç¨‹ IPC å¤„ç†å™¨ (`src/main/ipc/index.ts`)

- **åŠŸèƒ½**ï¼šè‡ªåŠ¨æ‰«æ IPC æ¨¡å—å¹¶æ³¨å†Œå¤„ç†å™¨
- **æ ¸å¿ƒæœºåˆ¶**ï¼šæ·±åº¦é€’å½’éå†æ¨¡å—ç»“æ„ï¼Œæ”¯æŒåµŒå¥—å‘½åç©ºé—´
- **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„é”™è¯¯åŒ…è£…å’Œè¿”å›æ ¼å¼

```typescript
function deepIpcHandle(module: Object, prefix: string = '') {
  const memberList = Object.keys(module);
  for (const memberName of memberList) {
    const handle = '' === prefix ? memberName : `${prefix}-${memberName}`;
    const member = module[memberName];
    if (typeof member === 'function') {
      ipcMain.handle(handle, (event: IpcMainInvokeEvent, ...args: any[]) => {
        return run(event, async () => {
          // ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œç»“æœåŒ…è£…
        });
      });
    }
    if (typeof member === 'object') {
      deepIpcHandle(member, handle); // æ”¯æŒåµŒå¥—æ¨¡å—
    }
  }
}
```

#### 2. ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (`src/main/ipc/ctx.ts`)

- **åŠŸèƒ½**ï¼šä½¿ç”¨ AsyncLocalStorage ç®¡ç†å¼‚æ­¥ä¸Šä¸‹æ–‡
- **ç”¨é€”**ï¼šåœ¨æ•´ä¸ªè°ƒç”¨é“¾ä¸­ä¼ é€’ IPC äº‹ä»¶å¯¹è±¡
- **ä¼˜åŠ¿**ï¼šæ— éœ€æ‰‹åŠ¨ä¼ é€’å‚æ•°ï¼Œä»»ä½•æ·±åº¦å‡½æ•°éƒ½èƒ½è®¿é—®ä¸Šä¸‹æ–‡

```typescript
export function run(subject: unknown, callback: () => Promise<unknown>) {
  return new Promise((resolve, reject) => {
    asyncLocalStorage.run(subject, async () => {
      try {
        const result = await callback();
        resolve(result);
      } catch (error) {
        reject(error);
      }
    });
  });
}
```

#### 3. æ¸²æŸ“å™¨ä»£ç†å®¢æˆ·ç«¯ (`src/renderer/handle.ts`)

- **åŠŸèƒ½**ï¼šåˆ›å»ºåŠ¨æ€ä»£ç†ï¼Œå®ç°é€æ˜çš„ IPC è°ƒç”¨
- **ç‰¹æ€§**ï¼šæ”¯æŒé“¾å¼è°ƒç”¨å’Œé”™è¯¯å¤„ç†
- **é€šçŸ¥ç³»ç»Ÿ**ï¼šåŸºäº WeakRef çš„è‡ªåŠ¨å†…å­˜ç®¡ç†

```typescript
const handle: ProxyHandler<ApiLike> = {
  get(target: ApiLike, name: string) {
    // åŠ¨æ€åˆ›å»ºåµŒå¥—ä»£ç†
    const parent = target.parent ? `${target.parent}-${name}` : name;
    async function executor() {}
    executor.parent = parent;
    return new Proxy(executor, handle);
  },
  apply(target: ApiLike, _thisArg, argumentsList: any[]) {
    // æ‰§è¡Œ IPC è°ƒç”¨
    return window.electron.ipcRenderer.invoke(target.parent, ...argumentsList);
  }
};
```

#### 4. é€šçŸ¥ç³»ç»Ÿ (`src/main/notify/index.ts`)

- **åŠŸèƒ½**ï¼šä¸»è¿›ç¨‹å‘æ¸²æŸ“å™¨æ¨é€äº‹ä»¶
- **ç‰¹æ€§**ï¼šæ”¯æŒå¤šçª—å£ã€è‡ªåŠ¨èµ„æºæ¸…ç†ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **å†…å­˜å®‰å…¨**ï¼šä½¿ç”¨ WeakRef é˜²æ­¢å†…å­˜æ³„æ¼

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js: `^20.19.0 || >=22.12.0`
- Electron: `^21.0.0`
- TypeScript: `^5.8.3`

### å®‰è£…å’Œè¿è¡Œ

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd violet-electron-ipc

# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼è¿è¡Œ
npm run dev

# æ„å»ºåº”ç”¨
npm run build
```

### åˆ›å»ºç¬¬ä¸€ä¸ª API

#### 1. åˆ›å»ºä¸»è¿›ç¨‹ API

åˆ›å»ºæ–‡ä»¶ `src/main/ipc/greeter.ts`ï¼š

```typescript
// src/main/ipc/greeter.ts

export function sayHello(name: string): string {
  return `ä½ å¥½, ${name}! è¿™æ¡æ¶ˆæ¯æ¥è‡ªä¸»è¿›ç¨‹ã€‚`;
}

export function sayGoodbye(): string {
  return 'å†è§!';
}

export async function asyncGreeting(name: string): Promise<string> {
  // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
  await new Promise(resolve => setTimeout(resolve, 1000));
  return `å¼‚æ­¥é—®å€™: ${name}`;
}
```

#### 2. åœ¨æ¸²æŸ“å™¨ä¸­è°ƒç”¨ API

```vue
<!-- src/renderer/src/components/GreetingComponent.vue -->
<template>
  <div>
    <h2>{{ greeting }}</h2>
    <button @click="sayHello">é—®å¥½</button>
    <button @click="sayGoodbye">å‘Šåˆ«</button>
    <button @click="asyncGreet">å¼‚æ­¥é—®å€™</button>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue';

const greeting = ref('');

async function sayHello() {
  try {
    greeting.value = await window.api.greeter.sayHello('å¼€å‘è€…');
  } catch (error) {
    console.error('è°ƒç”¨å¤±è´¥:', error);
  }
}

async function sayGoodbye() {
  greeting.value = await window.api.greeter.sayGoodbye();
}

async function asyncGreet() {
  greeting.value = 'æ­£åœ¨å¤„ç†ä¸­...';
  greeting.value = await window.api.greeter.asyncGreeting('ç”¨æˆ·');
}
</script>
```

---

## ğŸ“š è¯¦ç»†ä½¿ç”¨æŒ‡å—

### ä¸»è¿›ç¨‹ API å¼€å‘

#### 1. åŸºç¡€ API å®šä¹‰

åœ¨ `src/main/ipc/` ç›®å½•ä¸‹åˆ›å»ºçš„ä»»ä½• `.ts` æ–‡ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨å‘ç°å¹¶æš´éœ²ç»™æ¸²æŸ“å™¨è¿›ç¨‹ã€‚

```typescript
// src/main/ipc/calculator.ts
export function add(a: number, b: number): number {
  return a + b;
}

export function multiply(a: number, b: number): number {
  return a * b;
}

export function divide(a: number, b: number): number {
  if (b === 0) {
    throw new Error('é™¤æ•°ä¸èƒ½ä¸ºé›¶');
  }
  return a / b;
}
```

#### 2. åµŒå¥—æ¨¡å—ç»“æ„

æ”¯æŒåµŒå¥—çš„æ¨¡å—ç»“æ„ï¼Œåˆ›å»ºæ›´æœ‰ç»„ç»‡çš„ APIï¼š

```
src/main/ipc/
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ index.ts          # å¯¼å‡ºå­æ¨¡å—
â”‚   â”œâ”€â”€ users.ts          # ç”¨æˆ·ç›¸å…³æ“ä½œ
â”‚   â””â”€â”€ products.ts       # äº§å“ç›¸å…³æ“ä½œ
â””â”€â”€ file/
    â”œâ”€â”€ index.ts
    â”œâ”€â”€ read.ts           # æ–‡ä»¶è¯»å–æ“ä½œ
    â””â”€â”€ write.ts          # æ–‡ä»¶å†™å…¥æ“ä½œ
```

```typescript
// src/main/ipc/database/index.ts
export * as users from './users';
export * as products from './products';

// src/main/ipc/database/users.ts
export async function getUser(id: string) {
  // æ•°æ®åº“æŸ¥è¯¢é€»è¾‘
  return { id, name: 'John Doe' };
}

export async function createUser(userData: any) {
  // åˆ›å»ºç”¨æˆ·é€»è¾‘
  return { success: true, id: generateId() };
}
```

åœ¨æ¸²æŸ“å™¨ä¸­è°ƒç”¨ï¼š

```typescript
// è°ƒç”¨åµŒå¥— API
const user = await window.api.database.users.getUser('123');
const result = await window.api.database.products.createProduct(productData);
```

#### 3. ä½¿ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯

åœ¨ä¸»è¿›ç¨‹ API ä¸­è®¿é—® IPC ä¸Šä¸‹æ–‡ï¼š

```typescript
// src/main/ipc/window.ts
import { BrowserWindow, IpcMainInvokeEvent } from 'electron';
import { getStore } from './ctx';

export function maximize() {
  const event = getStore<IpcMainInvokeEvent>();
  const window = BrowserWindow.fromWebContents(event.sender);
  if (window) {
    window.maximize();
  }
}

export function setTitle(title: string) {
  const event = getStore<IpcMainInvokeEvent>();
  const window = BrowserWindow.fromWebContents(event.sender);
  if (window) {
    window.setTitle(title);
  }
}

export function getBounds() {
  const event = getStore<IpcMainInvokeEvent>();
  const window = BrowserWindow.fromWebContents(event.sender);
  return window ? window.getBounds() : null;
}
```

### æ¸²æŸ“å™¨ API è°ƒç”¨

#### 1. åŸºç¡€è°ƒç”¨æ¨¡å¼

```typescript
// ç›´æ¥è°ƒç”¨
const result = await window.api.moduleName.functionName(arg1, arg2);

// åµŒå¥—è°ƒç”¨
const user = await window.api.database.users.getUser('123');
const settings = await window.api.app.settings.get();
```

#### 2. é”™è¯¯å¤„ç†

æ¡†æ¶æä¾›äº†ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼š

```typescript
try {
  const result = await window.api.someModule.riskyOperation();
  console.log('æ“ä½œæˆåŠŸ:', result);
} catch (error) {
  console.error('æ“ä½œå¤±è´¥:', error.message);
  // é”™è¯¯å¯¹è±¡åŒ…å«åŸå§‹é”™è¯¯ä¿¡æ¯
  if (error.handle) {
    console.log('å¤±è´¥çš„å¤„ç†å™¨:', error.handle);
  }
}
```

#### 3. TypeScript æ”¯æŒ

ä¸ºäº†è·å¾—å®Œæ•´çš„ TypeScript æ”¯æŒï¼Œå¯ä»¥åˆ›å»ºç±»å‹å£°æ˜æ–‡ä»¶ï¼š

```typescript
// src/renderer/types/api.d.ts
interface Window {
  api: {
    greeter: {
      sayHello(name: string): Promise<string>;
      sayGoodbye(): Promise<string>;
      asyncGreeting(name: string): Promise<string>;
    };
    calculator: {
      add(a: number, b: number): Promise<number>;
      multiply(a: number, b: number): Promise<number>;
      divide(a: number, b: number): Promise<number>;
    };
    database: {
      users: {
        getUser(id: string): Promise<User>;
        createUser(userData: CreateUserRequest): Promise<CreateUserResponse>;
      };
    };
  };
  notify: {
    addListener(event: string, callback: Function): void;
    removeListener(event: string, callback: Function): void;
    removeAllListeners(event: string): void;
  };
}
```

### é€šçŸ¥ç³»ç»Ÿä½¿ç”¨

#### 1. ä¸»è¿›ç¨‹å‘é€é€šçŸ¥

```typescript
// åœ¨ä¸»è¿›ç¨‹çš„ä»»ä½•åœ°æ–¹å‘é€é€šçŸ¥
import { sendToWebContent } from '@/main/notify';

// å‘æ‰€æœ‰ç›‘å¬çª—å£å‘é€é€šçŸ¥
sendToWebContent('user-login', { userId: '123', username: 'John' });
sendToWebContent('download-progress', { progress: 75, total: 100 });
sendToWebContent('app-update-available', { version: '1.2.0' });
```

#### 2. æ¸²æŸ“å™¨ç›‘å¬é€šçŸ¥

```vue
<!-- Vue 3 ç»„ä»¶ç¤ºä¾‹ -->
<template>
  <div>
    <p>ç™»å½•çŠ¶æ€: {{ loginStatus }}</p>
    <p>ä¸‹è½½è¿›åº¦: {{ downloadProgress }}%</p>
    <div class="progress-bar">
      <div class="progress-fill" :style="{ width: downloadProgress + '%' }"></div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue';

const loginStatus = ref('æœªç™»å½•');
const downloadProgress = ref(0);

function onUserLogin(data: { userId: string, username: string }) {
  loginStatus.value = `å·²ç™»å½•: ${data.username}`;
  console.log('ç”¨æˆ·ç™»å½•äº‹ä»¶:', data);
}

function onDownloadProgress(data: { progress: number, total: number }) {
  downloadProgress.value = data.progress;
  console.log('ä¸‹è½½è¿›åº¦:', data);
}

onMounted(() => {
  // è‡ªåŠ¨ç»‘å®šçš„ç›‘å¬å™¨ï¼Œç»„ä»¶é”€æ¯æ—¶è‡ªåŠ¨æ¸…ç†
  window.notify.addListener('user-login', onUserLogin);
  window.notify.addListener('download-progress', onDownloadProgress);
});
</script>
```

#### 3. æ‰‹åŠ¨ç®¡ç†ç›‘å¬å™¨

è™½ç„¶æ¡†æ¶æä¾›äº†è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½éœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼š

```typescript
// æ·»åŠ ç›‘å¬å™¨
function handleNotification(data: any) {
  console.log('æ”¶åˆ°é€šçŸ¥:', data);
}

window.notify.addListener('my-event', handleNotification);

// æ‰‹åŠ¨ç§»é™¤ç›‘å¬å™¨
window.notify.removeListener('my-event', handleNotification);

// ç§»é™¤äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨
window.notify.removeAllListeners('my-event');
```

---

## ğŸ”§ é«˜çº§ç‰¹æ€§

### æ•°æ®æŒä¹…åŒ–

æ¡†æ¶å†…ç½®äº†ç®€å•çš„é”®å€¼å¯¹å­˜å‚¨åŠŸèƒ½ï¼š

```typescript
// src/main/ipc/store/index.ts
export function get<T>(key: string, defaultValue?: T): T {
  return AppStore.getInstance().get(key, defaultValue);
}

export function set<T>(key: string, newValue?: T): void {
  const oldValue = get(key);
  let mergeValue = newValue;
  if (typeof oldValue === 'object') {
    mergeValue = { ...oldValue, ...newValue };
  }
  return AppStore.getInstance().set(key, mergeValue);
}
```

ä½¿ç”¨ç¤ºä¾‹ï¼š

```typescript
// è®¾ç½®é…ç½®
await window.api.store.set('app.theme', 'dark');
await window.api.store.set('user.preferences', {
  language: 'zh-CN',
  autoSave: true
});

// è·å–é…ç½®
const theme = await window.api.store.get('app.theme', 'light');
const preferences = await window.api.store.get('user.preferences', {});
```

### å¼‚æ­¥æ“ä½œå’Œé”™è¯¯å¤„ç†

#### 1. å¼‚æ­¥ API å®šä¹‰

```typescript
// src/main/ipc/file.ts
import fs from 'fs/promises';
import path from 'path';

export async function readFile(filePath: string): Promise<string> {
  try {
    const content = await fs.readFile(filePath, 'utf-8');
    return content;
  } catch (error) {
    throw new Error(`è¯»å–æ–‡ä»¶å¤±è´¥: ${error.message}`);
  }
}

export async function writeFile(filePath: string, content: string): Promise<void> {
  try {
    const dir = path.dirname(filePath);
    await fs.mkdir(dir, { recursive: true });
    await fs.writeFile(filePath, content, 'utf-8');
  } catch (error) {
    throw new Error(`å†™å…¥æ–‡ä»¶å¤±è´¥: ${error.message}`);
  }
}
```

#### 2. æ¸²æŸ“å™¨ä¸­çš„å¼‚æ­¥å¤„ç†

```typescript
// ä¼˜é›…çš„å¼‚æ­¥é”™è¯¯å¤„ç†
async function handleFileOperation() {
  try {
    const content = await window.api.file.readFile('/path/to/file.txt');
    console.log('æ–‡ä»¶å†…å®¹:', content);

    await window.api.file.writeFile('/path/to/output.txt', content);
    console.log('æ–‡ä»¶å†™å…¥æˆåŠŸ');
  } catch (error) {
    console.error('æ–‡ä»¶æ“ä½œå¤±è´¥:', error.message);
    // å¯ä»¥æ ¹æ®é”™è¯¯ç±»å‹è¿›è¡Œä¸åŒçš„å¤„ç†
    if (error.message.includes('ENOENT')) {
      console.log('æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è·¯å¾„');
    }
  }
}
```

### ç±»å‹å®‰å…¨çš„ API è°ƒç”¨

#### 1. åˆ›å»ºå…±äº«ç±»å‹å®šä¹‰

```typescript
// src/shared/types.ts
export interface User {
  id: string;
  name: string;
  email: string;
  createdAt: Date;
}

export interface CreateUserRequest {
  name: string;
  email: string;
}

export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}
```

#### 2. åœ¨ä¸»è¿›ç¨‹ä¸­ä½¿ç”¨ç±»å‹

```typescript
// src/main/ipc/users.ts
import type { User, CreateUserRequest, ApiResponse } from '@/shared/types';

export async function createUser(request: CreateUserRequest): Promise<ApiResponse<User>> {
  try {
    // éªŒè¯è¾“å…¥
    if (!request.name || !request.email) {
      return {
        success: false,
        error: 'å§“åå’Œé‚®ç®±ä¸èƒ½ä¸ºç©º'
      };
    }

    // åˆ›å»ºç”¨æˆ·é€»è¾‘
    const user: User = {
      id: generateId(),
      name: request.name,
      email: request.email,
      createdAt: new Date()
    };

    // ä¿å­˜åˆ°æ•°æ®åº“
    await saveUserToDatabase(user);

    return {
      success: true,
      data: user
    };
  } catch (error) {
    return {
      success: false,
      error: error.message
    };
  }
}
```

#### 3. åœ¨æ¸²æŸ“å™¨ä¸­ä½¿ç”¨ç±»å‹

```typescript
// src/renderer/src/services/userService.ts
import type { User, CreateUserRequest, ApiResponse } from '@/shared/types';

class UserService {
  async createUser(request: CreateUserRequest): Promise<User> {
    const response: ApiResponse<User> = await window.api.users.createUser(request);

    if (!response.success) {
      throw new Error(response.error || 'åˆ›å»ºç”¨æˆ·å¤±è´¥');
    }

    return response.data!;
  }

  async getUserById(id: string): Promise<User> {
    const response: ApiResponse<User> = await window.api.users.getUserById(id);

    if (!response.success) {
      throw new Error(response.error || 'è·å–ç”¨æˆ·å¤±è´¥');
    }

    return response.data!;
  }
}

export const userService = new UserService();
```

---

## ğŸ—ï¸ æ„å»ºä¸éƒ¨ç½²

### æ ‡å‡†æ„å»º

```bash
# ç±»å‹æ£€æŸ¥å’Œæ„å»º
npm run build

# æ„å»ºä¸åŒå¹³å°
npm run build:win      # Windows
npm run build:mac      # macOS
npm run build:linux    # Linux

# å¼€å‘æ„å»ºï¼ˆä¸æ‰“åŒ…ï¼‰
npm run build:unpack
```

### ä¼˜åŒ–æ„å»ºï¼šåˆ†ç¦» node_modules

ä¸ºäº†æå‡æ€§èƒ½å¹¶å®ç°æ›´é«˜æ•ˆçš„æ›´æ–°ï¼Œé¡¹ç›®æ”¯æŒå°†æœ€ç»ˆæ‰“åŒ…çš„åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„ `asar` å½’æ¡£æ–‡ä»¶ï¼š

#### ä¼˜åŠ¿

1. **æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦**ï¼šElectron å¯ä»¥æ›´å¿«åœ°åŠ è½½è¾ƒå°çš„ `app.asar`
2. **é«˜æ•ˆçš„æ›´æ–°**ï¼šç”¨æˆ·é€šå¸¸åªéœ€è¦ä¸‹è½½å·²æ›´æ”¹çš„ `app.asar`

#### æ„å»ºå‘½ä»¤

```bash
# åˆ›å»ºå¯ç”¨ asar æ‹†åˆ†çš„æ„å»º
npm run build:tiny:win
```

#### æ„å»ºæµç¨‹è¯´æ˜

1. **`config/electron-build/split-asar-builder.mjs`**ï¼šè‡ªå®šä¹‰æ„å»ºå…¥å£ç‚¹
2. **`config/electron-build/split-asar-builder-handle.cjs`**ï¼šåˆ†ç¦» `node_modules` åˆ° `deps.asar`
3. **`config/vite-plugin/split-deps-loader.vite.config.ts`**ï¼šæ³¨å…¥åŠ è½½å™¨è„šæœ¬
4. **`config/electron-build/split-asar-builder-dep-loader.cjs`**ï¼šè¿è¡Œæ—¶ä¾èµ–åŠ è½½å™¨

æ„å»ºå®Œæˆåï¼Œ`out/` ç›®å½•ä¸­å°†åŒ…å«ï¼š
- `resources/app.asar`ï¼šåº”ç”¨ç¨‹åºæºä»£ç 
- `resources/deps.asar`ï¼šä¾èµ–é¡¹

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. API è®¾è®¡åŸåˆ™

#### å•ä¸€èŒè´£
æ¯ä¸ª API å‡½æ•°åº”è¯¥åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½ï¼š

```typescript
// âœ… å¥½çš„è®¾è®¡
export function getUser(id: string): Promise<User> { }
export function updateUser(id: string, data: Partial<User>): Promise<User> { }
export function deleteUser(id: string): Promise<void> { }

// âŒ é¿å…è¿™æ ·è®¾è®¡
export async function manageUser(action: string, id: string, data?: any): Promise<any> { }
```

#### è¾“å…¥éªŒè¯
åœ¨ä¸»è¿›ç¨‹ä¸­å§‹ç»ˆéªŒè¯è¾“å…¥å‚æ•°ï¼š

```typescript
export function createUser(userData: { name: string, email: string }): Promise<User> {
  if (!userData.name || userData.name.trim().length === 0) {
    throw new Error('ç”¨æˆ·åä¸èƒ½ä¸ºç©º');
  }

  if (!userData.email || !isValidEmail(userData.email)) {
    throw new Error('é‚®ç®±æ ¼å¼æ— æ•ˆ');
  }

  // ç»§ç»­å¤„ç†...
}
```

#### é”™è¯¯å¤„ç†
æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯ï¼š

```typescript
export async function readFile(filePath: string): Promise<string> {
  try {
    return await fs.readFile(filePath, 'utf-8');
  } catch (error) {
    if (error.code === 'ENOENT') {
      throw new Error(`æ–‡ä»¶ä¸å­˜åœ¨: ${filePath}`);
    } else if (error.code === 'EACCES') {
      throw new Error(`æ²¡æœ‰æƒé™è¯»å–æ–‡ä»¶: ${filePath}`);
    } else {
      throw new Error(`è¯»å–æ–‡ä»¶å¤±è´¥: ${error.message}`);
    }
  }
}
```

### 2. æ¨¡å—ç»„ç»‡

#### æŒ‰åŠŸèƒ½åˆ†ç»„
å°†ç›¸å…³çš„ API ç»„ç»‡åˆ°åŒä¸€ä¸ªæ¨¡å—ä¸­ï¼š

```
src/main/ipc/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ login.ts
â”‚   â”œâ”€â”€ register.ts
â”‚   â””â”€â”€ logout.ts
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ users.ts
â”‚   â”œâ”€â”€ products.ts
â”‚   â””â”€â”€ orders.ts
â”œâ”€â”€ file/
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ read.ts
â”‚   â”œâ”€â”€ write.ts
â”‚   â””â”€â”€ metadata.ts
â””â”€â”€ system/
    â”œâ”€â”€ index.ts
    â”œâ”€â”€ info.ts
    â””â”€â”€ settings.ts
```

#### ä½¿ç”¨ barrel exports
åœ¨ `index.ts` æ–‡ä»¶ä¸­å¯¼å‡ºæ¨¡å—å†…å®¹ï¼š

```typescript
// src/main/ipc/auth/index.ts
export * as login from './login';
export * as register from './register';
export * as logout from './logout';

// src/main/ipc/handles.ts
export * as auth from './auth';
export * as database from './database';
export * as file from './file';
export * as system from './system';
```

### 3. æ€§èƒ½ä¼˜åŒ–

#### é¿å…é¢‘ç¹çš„ IPC è°ƒç”¨
æ‰¹é‡å¤„ç†å¤šä¸ªæ“ä½œï¼š

```typescript
// âŒ é¿å…å¤šæ¬¡è°ƒç”¨
for (const item of items) {
  await window.api.database.saveItem(item);
}

// âœ… æ‰¹é‡å¤„ç†
await window.api.database.saveItems(items);
```

#### ç¼“å­˜ç»“æœ
åœ¨æ¸²æŸ“å™¨ä¸­ç¼“å­˜é¢‘ç¹è®¿é—®çš„æ•°æ®ï¼š

```typescript
class ConfigService {
  private cache: Map<string, any> = new Map();

  async getConfig(key: string): Promise<any> {
    if (this.cache.has(key)) {
      return this.cache.get(key);
    }

    const value = await window.api.config.get(key);
    this.cache.set(key, value);
    return value;
  }

  invalidateCache(key?: string) {
    if (key) {
      this.cache.delete(key);
    } else {
      this.cache.clear();
    }
  }
}
```

#### ä½¿ç”¨æµå¼å¤„ç†
å¯¹äºå¤§é‡æ•°æ®ï¼Œä½¿ç”¨æµå¼å¤„ç†ï¼š

```typescript
// ä¸»è¿›ç¨‹
export async function exportLargeData(): Promise<string> {
  const stream = fs.createReadStream('/path/to/large/file.json');
  // æµå¼å¤„ç†é€»è¾‘
  return streamPath;
}

// æ¸²æŸ“å™¨
const filePath = await window.api.data.exportLargeData();
// åˆ†å—è¯»å–å’Œå¤„ç†
```

### 4. å®‰å…¨è€ƒè™‘

#### è¾“å…¥æ¸…ç†
å§‹ç»ˆæ¸…ç†å’ŒéªŒè¯æ¥è‡ªæ¸²æŸ“å™¨çš„è¾“å…¥ï¼š

```typescript
import path from 'path';

export function readFile(filePath: string): Promise<string> {
  // é˜²æ­¢è·¯å¾„éå†æ”»å‡»
  const normalizedPath = path.normalize(filePath);
  if (normalizedPath.includes('..')) {
    throw new Error('ä¸å…è®¸çš„è·¯å¾„');
  }

  // ç¡®ä¿è·¯å¾„åœ¨å…è®¸çš„ç›®å½•å†…
  const allowedDir = path.resolve('/app/data');
  const fullPath = path.resolve(allowedDir, normalizedPath);

  if (!fullPath.startsWith(allowedDir)) {
    throw new Error('è®¿é—®è¢«æ‹’ç»');
  }

  return fs.readFile(fullPath, 'utf-8');
}
```

#### æƒé™æ£€æŸ¥
ä½¿ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯è¿›è¡Œæƒé™æ£€æŸ¥ï¼š

```typescript
export function deleteFile(filePath: string): Promise<void> {
  const event = getStore<IpcMainInvokeEvent>();
  const window = BrowserWindow.fromWebContents(event.sender);

  // æ£€æŸ¥çª—å£æ˜¯å¦æœ‰æƒé™æ‰§è¡Œæ­¤æ“ä½œ
  if (!hasPermission(window, 'file.delete')) {
    throw new Error('æ²¡æœ‰åˆ é™¤æ–‡ä»¶çš„æƒé™');
  }

  // ç»§ç»­å¤„ç†...
}
```

### 5. æµ‹è¯•ç­–ç•¥

#### å•å…ƒæµ‹è¯•
ä¸ºä¸»è¿›ç¨‹ API ç¼–å†™å•å…ƒæµ‹è¯•ï¼š

```typescript
// tests/main/ipc/calculator.test.ts
import { describe, it, expect } from 'vitest';
import { add, multiply, divide } from '@/main/ipc/calculator';

describe('Calculator API', () => {
  it('should add two numbers', () => {
    expect(add(2, 3)).toBe(5);
  });

  it('should multiply two numbers', () => {
    expect(multiply(2, 3)).toBe(6);
  });

  it('should throw error when dividing by zero', () => {
    expect(() => divide(10, 0)).toThrow('é™¤æ•°ä¸èƒ½ä¸ºé›¶');
  });
});
```

#### é›†æˆæµ‹è¯•
æµ‹è¯• IPC é€šä¿¡ï¼š

```typescript
// tests/integration/ipc.test.ts
import { app, BrowserWindow } from 'electron';
import { callMainProcessApi } from '../helpers/electron';

describe('IPC Integration', () => {
  let window: BrowserWindow;

  beforeAll(async () => {
    await app.whenReady();
    window = new BrowserWindow({
      show: false,
      webPreferences: {
        nodeIntegration: true,
        contextIsolation: false
      }
    });
  });

  it('should call calculator API', async () => {
    const result = await window.webContents.executeJavaScript(`
      window.api.calculator.add(5, 3)
    `);

    expect(result).toBe(8);
  });
});
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•è°ƒè¯• IPC é€šä¿¡ï¼Ÿ

**A**: åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è°ƒè¯•ï¼š

```typescript
// ä¸»è¿›ç¨‹ä¸­æ·»åŠ æ—¥å¿—
ipcMain.handle('my-api', (event, ...args) => {
  console.log('API è°ƒç”¨:', event.sender.id, args);
  // å¤„ç†é€»è¾‘...
});

// æ¸²æŸ“å™¨ä¸­æ·»åŠ æ—¥å¿—
const result = await window.api.myModule.myFunction(args);
console.log('API ç»“æœ:', result);
```

### Q2: å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ä¼ è¾“ï¼Ÿ

**A**: å¯¹äºå¤§æ–‡ä»¶ï¼Œå»ºè®®ä½¿ç”¨æµå¼å¤„ç†æˆ–æ–‡ä»¶è·¯å¾„ä¼ é€’ï¼š

```typescript
// ä¸»è¿›ç¨‹
export function getFilePath(filename: string): Promise<string> {
  return path.join('/app/data', filename);
}

// æ¸²æŸ“å™¨
const filePath = await window.api.file.getFilePath('large-file.pdf');
// ä½¿ç”¨ fetch æˆ–å…¶ä»–æ–¹å¼è¯»å–æ–‡ä»¶
```

### Q3: å¦‚ä½•å®ç°å®æ—¶æ•°æ®åŒæ­¥ï¼Ÿ

**A**: ä½¿ç”¨é€šçŸ¥ç³»ç»Ÿç»“åˆå®šæ—¶å™¨ï¼š

```typescript
// ä¸»è¿›ç¨‹ - å®šæœŸå‘é€æ›´æ–°
setInterval(() => {
  const data = getLatestData();
  sendToWebContent('data-update', data);
}, 1000);

// æ¸²æŸ“å™¨ - ç›‘å¬æ›´æ–°
onMounted(() => {
  window.notify.addListener('data-update', (data) => {
    updateLocalData(data);
  });
});
```

### Q4: å¦‚ä½•å¤„ç†å¹¶å‘è¯·æ±‚ï¼Ÿ

**A**: æ¡†æ¶è‡ªåŠ¨å¤„ç†å¹¶å‘è¯·æ±‚ï¼Œä½†éœ€è¦æ³¨æ„èµ„æºç«äº‰ï¼š

```typescript
// ä¸»è¿›ç¨‹ - ä½¿ç”¨äº’æ–¥é”
const lockMap = new Map<string, Promise<any>>();

export async function updateResource(id: string, data: any): Promise<void> {
  if (lockMap.has(id)) {
    await lockMap.get(id);
  }

  const updatePromise = performUpdate(id, data);
  lockMap.set(id, updatePromise);

  try {
    await updatePromise;
  } finally {
    lockMap.delete(id);
  }
}
```

### Q5: å¦‚ä½•å®ç° API ç‰ˆæœ¬æ§åˆ¶ï¼Ÿ

**A**: ä½¿ç”¨å‘½åç©ºé—´æˆ–å‰ç¼€ï¼š

```typescript
// src/main/ipc/v1/users.ts
export async function getUser(id: string): Promise<User> { }

// src/main/ipc/v2/users.ts
export async function getUser(id: string): Promise<UserV2> { }

// src/main/ipc/handles.ts
export * as v1 from './v1';
export * as v2 from './v2';
```

è°ƒç”¨æ—¶ï¼š`window.api.v1.users.getUser()` æˆ– `window.api.v2.users.getUser()`

### Q6: å¦‚ä½•å¤„ç†å†…å­˜æ³„æ¼ï¼Ÿ

**A**: æ¡†æ¶å·²ç»æä¾›äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œä½†ä»å»ºè®®ï¼š

1. **åŠæ—¶æ¸…ç†èµ„æº**ï¼šå¯¹äºé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œï¼Œç¡®ä¿æ­£ç¡®æ¸…ç†
2. **é¿å…é—­åŒ…é™·é˜±**ï¼šåœ¨äº‹ä»¶ç›‘å¬å™¨ä¸­é¿å…ä¸å¿…è¦çš„é—­åŒ…
3. **å®šæœŸæ£€æŸ¥**ï¼šä½¿ç”¨ Chrome DevTools çš„ Memory é¢æ¿æ£€æŸ¥å†…å­˜ä½¿ç”¨

```typescript
// âœ… æ­£ç¡®çš„åšæ³•
onMounted(() => {
  const handler = (data) => processData(data);
  window.notify.addListener('event', handler);

  // æ¡†æ¶ä¼šè‡ªåŠ¨æ¸…ç†ï¼Œä½†ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ¸…ç†
  onUnmounted(() => {
    window.notify.removeListener('event', handler);
  });
});
```

### Q7: å¦‚ä½•å®ç° API è¶…æ—¶æ§åˆ¶ï¼Ÿ

**A**: åœ¨æ¸²æŸ“å™¨ä¸­å®ç°è¶…æ—¶åŒ…è£…ï¼š

```typescript
async function callWithTimeout<T>(apiCall: Promise<T>, timeout: number): Promise<T> {
  const timeoutPromise = new Promise<never>((_, reject) => {
    setTimeout(() => reject(new Error('API è°ƒç”¨è¶…æ—¶')), timeout);
  });

  return Promise.race([apiCall, timeoutPromise]);
}

// ä½¿ç”¨
try {
  const result = await callWithTimeout(
    window.api.slowOperation.data(),
    5000 // 5ç§’è¶…æ—¶
  );
} catch (error) {
  if (error.message === 'API è°ƒç”¨è¶…æ—¶') {
    console.log('æ“ä½œè¶…æ—¶ï¼Œè¯·é‡è¯•');
  }
}
```

---

## ğŸ“ æ€»ç»“

Violet Electron IPC æ¡†æ¶æä¾›äº†ä¸€ä¸ªä¼˜é›…ã€é«˜æ•ˆä¸”å®‰å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œç”¨äºå¤„ç† Electron åº”ç”¨ä¸­çš„è¿›ç¨‹é—´é€šä¿¡ã€‚é€šè¿‡å…¶åˆ›æ–°çš„ä»£ç†æœºåˆ¶ã€è‡ªåŠ¨ä¸Šä¸‹æ–‡ä¼ æ’­å’Œå†…å­˜å®‰å…¨çš„é€šçŸ¥ç³»ç»Ÿï¼Œå¼€å‘è€…å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘è€Œæ— éœ€å¤„ç†ç¹ççš„ IPC æ ·æ¿ä»£ç ã€‚

### å…³é”®ä¼˜åŠ¿å›é¡¾

- **é›¶é…ç½®**ï¼šåŸºäºæ–‡ä»¶ç»“æ„çš„è‡ªåŠ¨ API å‘ç°
- **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript æ”¯æŒ
- **å†…å­˜å®‰å…¨**ï¼šè‡ªåŠ¨æ¸…ç†çš„äº‹ä»¶ç›‘å¬å™¨
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šéšå¼çš„å¼‚æ­¥ä¸Šä¸‹æ–‡ä¼ æ’­
- **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–çš„æ„å»ºå’Œéƒ¨ç½²ç­–ç•¥

### é€‚ç”¨åœºæ™¯

è¯¥æ¡†æ¶ç‰¹åˆ«é€‚åˆï¼š
- éœ€è¦å¤æ‚è¿›ç¨‹é—´é€šä¿¡çš„ Electron åº”ç”¨
- è¦æ±‚ç±»å‹å®‰å…¨çš„é¡¹ç›®
- å…³æ³¨å†…å­˜ç®¡ç†çš„é•¿æœŸè¿è¡Œåº”ç”¨
- éœ€è¦å¿«é€ŸåŸå‹å¼€å‘çš„é¡¹ç›®

é€šè¿‡éµå¾ªæœ¬æŒ‡å—çš„æœ€ä½³å®è·µï¼Œæ‚¨å¯ä»¥æ„å»ºå‡ºé«˜è´¨é‡ã€å¯ç»´æŠ¤çš„ Electron åº”ç”¨ã€‚